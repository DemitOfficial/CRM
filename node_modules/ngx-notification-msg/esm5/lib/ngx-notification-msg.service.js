/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { ApplicationRef, ComponentFactoryResolver, Injectable, Injector } from '@angular/core';
import { NgxNotificationMsgComponent } from './ngx-notification-msg.component';
import * as i0 from "@angular/core";
import * as ɵngcc0 from '@angular/core';
var NgxNotificationMsgService = /** @class */ (function () {
    function NgxNotificationMsgService(componentFactoryResolver, appRef, injector) {
        this.componentFactoryResolver = componentFactoryResolver;
        this.appRef = appRef;
        this.injector = injector;
        this.defaultContainer = document.querySelector('body');
        this.containerToChildComponentsRef = new Map();
    }
    /**
     * @private
     * @param {?} componentFactoryResolver
     * @param {?} appRef
     * @param {?} injector
     * @param {?} container
     * @return {?}
     */
    NgxNotificationMsgService.appendChildComponentRef = /**
     * @private
     * @param {?} componentFactoryResolver
     * @param {?} appRef
     * @param {?} injector
     * @param {?} container
     * @return {?}
     */
    function (componentFactoryResolver, appRef, injector, container) {
        /** @type {?} */
        var childComponentRef = componentFactoryResolver
            .resolveComponentFactory(NgxNotificationMsgComponent)
            .create(injector);
        /** @type {?} */
        var childDomElem = (/** @type {?} */ (((/** @type {?} */ (childComponentRef.hostView)))
            .rootNodes[0]));
        appRef.attachView(childComponentRef.hostView);
        container.appendChild(childDomElem);
        return childComponentRef;
    };
    /**
     * @private
     * @param {?} inputsConfig
     * @param {?} componentRef
     * @return {?}
     */
    NgxNotificationMsgService.attachConfig = /**
     * @private
     * @param {?} inputsConfig
     * @param {?} componentRef
     * @return {?}
     */
    function (inputsConfig, componentRef) {
        Object.keys(inputsConfig).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            componentRef.instance[key] = inputsConfig[key];
        }));
    };
    /**
     * @private
     * @param {?} container
     * @param {?} containerToChildComponentsRef
     * @param {?} childComponentRef
     * @return {?}
     */
    NgxNotificationMsgService.addChildComponentRef = /**
     * @private
     * @param {?} container
     * @param {?} containerToChildComponentsRef
     * @param {?} childComponentRef
     * @return {?}
     */
    function (container, containerToChildComponentsRef, childComponentRef) {
        if (containerToChildComponentsRef.has(container)) {
            containerToChildComponentsRef.get(container).push(childComponentRef);
        }
        else {
            containerToChildComponentsRef.set(container, [childComponentRef]);
        }
    };
    /**
     * @private
     * @param {?} appRef
     * @param {?} containerToChildComponentsRef
     * @param {?} componentRef
     * @return {?}
     */
    NgxNotificationMsgService.subscribeToComponentDestroyEvent = /**
     * @private
     * @param {?} appRef
     * @param {?} containerToChildComponentsRef
     * @param {?} componentRef
     * @return {?}
     */
    function (appRef, containerToChildComponentsRef, componentRef) {
        /** @type {?} */
        var sub = componentRef.instance.destroy.subscribe((/**
         * @return {?}
         */
        function () {
            sub.unsubscribe();
            NgxNotificationMsgService.destroy(appRef, componentRef);
            NgxNotificationMsgService.removeChildComponentRef(containerToChildComponentsRef, componentRef);
            NgxNotificationMsgService.updateComponentsIndexesOnDestroy(containerToChildComponentsRef);
        }));
    };
    /**
     * @private
     * @param {?} appRef
     * @param {?} componentRef
     * @return {?}
     */
    NgxNotificationMsgService.destroy = /**
     * @private
     * @param {?} appRef
     * @param {?} componentRef
     * @return {?}
     */
    function (appRef, componentRef) {
        appRef.detachView(componentRef.hostView);
        componentRef.destroy();
    };
    /**
     * @private
     * @param {?} containerToChildComponentsRef
     * @return {?}
     */
    NgxNotificationMsgService.updateComponentsIndexesOnDestroy = /**
     * @private
     * @param {?} containerToChildComponentsRef
     * @return {?}
     */
    function (containerToChildComponentsRef) {
        containerToChildComponentsRef.forEach((/**
         * @param {?} value
         * @param {?} key
         * @return {?}
         */
        function (value, key) {
            /** @type {?} */
            var total = containerToChildComponentsRef.get(key).length - 1;
            containerToChildComponentsRef.get(key).forEach((/**
             * @param {?} __0
             * @return {?}
             */
            function (_a) {
                var instance = _a.instance;
                instance.index = total--;
            }));
        }));
    };
    /**
     * @private
     * @param {?} containerToChildComponentsRef
     * @param {?} componentRef
     * @return {?}
     */
    NgxNotificationMsgService.removeChildComponentRef = /**
     * @private
     * @param {?} containerToChildComponentsRef
     * @param {?} componentRef
     * @return {?}
     */
    function (containerToChildComponentsRef, componentRef) {
        containerToChildComponentsRef.forEach((/**
         * @param {?} value
         * @param {?} key
         * @return {?}
         */
        function (value, key) {
            containerToChildComponentsRef.set(key, tslib_1.__spread(containerToChildComponentsRef.get(key).filter((/**
             * @param {?} _
             * @return {?}
             */
            function (_) { return _ !== componentRef; }))));
        }));
    };
    /**
     * @private
     * @param {?} containerToChildComponentsRef
     * @return {?}
     */
    NgxNotificationMsgService.updateComponentsIndexesOnOpen = /**
     * @private
     * @param {?} containerToChildComponentsRef
     * @return {?}
     */
    function (containerToChildComponentsRef) {
        containerToChildComponentsRef.forEach((/**
         * @param {?} value
         * @param {?} key
         * @return {?}
         */
        function (value, key) {
            /** @type {?} */
            var total = containerToChildComponentsRef.get(key).length;
            containerToChildComponentsRef.get(key).forEach((/**
             * @param {?} __0
             * @return {?}
             */
            function (_a) {
                var instance = _a.instance;
                instance.index = --total;
            }));
        }));
    };
    /**
     * @param {?} inputsConfig
     * @param {?=} element
     * @return {?}
     */
    NgxNotificationMsgService.prototype.open = /**
     * @param {?} inputsConfig
     * @param {?=} element
     * @return {?}
     */
    function (inputsConfig, element) {
        /** @type {?} */
        var container = element ? element : this.defaultContainer;
        /** @type {?} */
        var childComponentRef = NgxNotificationMsgService.appendChildComponentRef(this.componentFactoryResolver, this.appRef, this.injector, container);
        NgxNotificationMsgService.attachConfig(inputsConfig, childComponentRef);
        NgxNotificationMsgService.addChildComponentRef(container, this.containerToChildComponentsRef, childComponentRef);
        NgxNotificationMsgService.subscribeToComponentDestroyEvent(this.appRef, this.containerToChildComponentsRef, childComponentRef);
        NgxNotificationMsgService.updateComponentsIndexesOnOpen(this.containerToChildComponentsRef);
    };
    /** @nocollapse */
    NgxNotificationMsgService.ctorParameters = function () { return [
        { type: ComponentFactoryResolver },
        { type: ApplicationRef },
        { type: Injector }
    ]; };
    /** @nocollapse */ NgxNotificationMsgService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function NgxNotificationMsgService_Factory() { return new NgxNotificationMsgService(i0.ɵɵinject(i0.ComponentFactoryResolver), i0.ɵɵinject(i0.ApplicationRef), i0.ɵɵinject(i0.INJECTOR)); }, token: NgxNotificationMsgService, providedIn: "root" });
NgxNotificationMsgService.ɵfac = function NgxNotificationMsgService_Factory(t) { return new (t || NgxNotificationMsgService)(ɵngcc0.ɵɵinject(ɵngcc0.ComponentFactoryResolver), ɵngcc0.ɵɵinject(ɵngcc0.ApplicationRef), ɵngcc0.ɵɵinject(ɵngcc0.Injector)); };
NgxNotificationMsgService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: NgxNotificationMsgService, factory: function (t) { return NgxNotificationMsgService.ɵfac(t); }, providedIn: 'root' });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(NgxNotificationMsgService, [{
        type: Injectable,
        args: [{
                providedIn: 'root'
            }]
    }], function () { return [{ type: ɵngcc0.ComponentFactoryResolver }, { type: ɵngcc0.ApplicationRef }, { type: ɵngcc0.Injector }]; }, null); })();
    return NgxNotificationMsgService;
}());
export { NgxNotificationMsgService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    NgxNotificationMsgService.prototype.defaultContainer;
    /**
     * @type {?}
     * @private
     */
    NgxNotificationMsgService.prototype.containerToChildComponentsRef;
    /**
     * @type {?}
     * @private
     */
    NgxNotificationMsgService.prototype.componentFactoryResolver;
    /**
     * @type {?}
     * @private
     */
    NgxNotificationMsgService.prototype.appRef;
    /**
     * @type {?}
     * @private
     */
    NgxNotificationMsgService.prototype.injector;
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LW5vdGlmaWNhdGlvbi1tc2cuc2VydmljZS5qcyIsInNvdXJjZXMiOlsibmd4LW5vdGlmaWNhdGlvbi1tc2cvbGliL25neC1ub3RpZmljYXRpb24tbXNnLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUMsY0FBYyxFQUFFLHdCQUF3QixFQUFpQyxVQUFVLEVBQUUsUUFBUSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQzVILE9BQU8sRUFBNEIsMkJBQTJCLEVBQUMsTUFBTSxrQ0FBa0MsQ0FBQztBQUN4Rzs7QUFDQTtBQUdxQixJQUtqQixtQ0FBNkIsd0JBQWtELEVBQ2xELE1BQXNCLEVBQ3RCLFFBQWtCO0FBQ25ELFFBSGlDLDZCQUF3QixHQUF4Qix3QkFBd0IsQ0FBMEI7QUFBQyxRQUNuRCxXQUFNLEdBQU4sTUFBTSxDQUFnQjtBQUFDLFFBQ3ZCLGFBQVEsR0FBUixRQUFRLENBQVU7QUFBQyxRQUwvQixxQkFBZ0IsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3ZFLFFBQXFCLGtDQUE2QixHQUFHLElBQUksR0FBRyxFQUFnQyxDQUFDO0FBQzdGLElBSUksQ0FBQztBQUNMO0FBQ087QUFBZ0I7QUFBMkM7QUFBeUI7QUFDcEU7QUFBNEI7QUFDaEQ7QUFBUSxJQUZRLGlEQUF1QjtBQUFPO0FBQWdCO0FBQ3BEO0FBQXlCO0FBQTJCO0FBQ3ZDO0FBQW1CO0FBQVEsSUFGakQsVUFBdUMsd0JBQWtELEVBQ2xELE1BQXNCLEVBQ3RCLFFBQWtCLEVBQ2xCLFNBQWtCO0FBQUk7QUFDM0QsWUFBUSxpQkFBaUIsR0FBRyx3QkFBd0I7QUFDMUQsYUFBYSx1QkFBdUIsQ0FBQywyQkFBMkIsQ0FBQztBQUNqRSxhQUFhLE1BQU0sQ0FBQyxRQUFRLENBQUM7QUFDN0I7QUFBeUIsWUFBWCxZQUFZLEdBQUcsbUJBQUEsQ0FBQyxtQkFBQSxpQkFBaUIsQ0FBQyxRQUFRLEVBQXdCLENBQUM7QUFDakYsYUFB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SXVDLGdCQVJyQyx3QkFBd0I7Q0FLL0MsREFMbUQsZ0JBQTVDLGNBQWM7QUFBSSxnQkFBbUUsUUFBUTtBQUFHO0FBQVU7Ozs7Ozs7O3FKQVN6QztBQUFDLG9DQVQxRTtBQUFFLENBc0dELEFBbkdELElBbUdDO0FBQ0QsU0FqR2EseUJBQXlCO0FBRXRDO0FBQWE7QUFBUTtBQUFpQjtBQUFnQjtBQUFRLElBQTFELHFEQUFtRTtBQUN2RTtBQUFRO0FBQWlCO0FBQWdCO0FBQVEsSUFBN0Msa0VBQXlGO0FBQzdGO0FBQ087QUFBaUI7QUFBZ0I7QUFBUSxJQUFoQyw2REFBbUU7QUFBQztBQUM3RTtBQUFpQjtBQUFnQjtBQUFRLElBQWhDLDJDQUF1QztBQUFDO0FBQ2pEO0FBQWlCO0FBQWdCO0FBQVEsSUFBaEMsNkNBQW1DO0FBQUM7QUFBRSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7QXBwbGljYXRpb25SZWYsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgQ29tcG9uZW50UmVmLCBFbWJlZGRlZFZpZXdSZWYsIEluamVjdGFibGUsIEluamVjdG9yfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7SU5neE5vdGlmaWNhdGlvbk1zZ0NvbmZpZywgTmd4Tm90aWZpY2F0aW9uTXNnQ29tcG9uZW50fSBmcm9tICcuL25neC1ub3RpZmljYXRpb24tbXNnLmNvbXBvbmVudCc7XG5cbkBJbmplY3RhYmxlKHtcbiAgICBwcm92aWRlZEluOiAncm9vdCdcbn0pXG5leHBvcnQgY2xhc3MgTmd4Tm90aWZpY2F0aW9uTXNnU2VydmljZSB7XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IGRlZmF1bHRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG4gICAgcHJpdmF0ZSByZWFkb25seSBjb250YWluZXJUb0NoaWxkQ29tcG9uZW50c1JlZiA9IG5ldyBNYXA8RWxlbWVudCwgQ2hpbGRDb21wb25lbnRSZWZbXT4oKTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgY29tcG9uZW50RmFjdG9yeVJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSByZWFkb25seSBhcHBSZWY6IEFwcGxpY2F0aW9uUmVmLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgcmVhZG9ubHkgaW5qZWN0b3I6IEluamVjdG9yKSB7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgYXBwZW5kQ2hpbGRDb21wb25lbnRSZWYoY29tcG9uZW50RmFjdG9yeVJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwUmVmOiBBcHBsaWNhdGlvblJlZixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmplY3RvcjogSW5qZWN0b3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiBFbGVtZW50KTogQ2hpbGRDb21wb25lbnRSZWYge1xuICAgICAgICBjb25zdCBjaGlsZENvbXBvbmVudFJlZiA9IGNvbXBvbmVudEZhY3RvcnlSZXNvbHZlclxuICAgICAgICAgICAgLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KE5neE5vdGlmaWNhdGlvbk1zZ0NvbXBvbmVudClcbiAgICAgICAgICAgIC5jcmVhdGUoaW5qZWN0b3IpO1xuICAgICAgICBjb25zdCBjaGlsZERvbUVsZW0gPSAoY2hpbGRDb21wb25lbnRSZWYuaG9zdFZpZXcgYXMgRW1iZWRkZWRWaWV3UmVmPGFueT4pXG4gICAgICAgICAgICAucm9vdE5vZGVzWzBdIGFzIEhUTUxFbGVtZW50O1xuXG4gICAgICAgIGFwcFJlZi5hdHRhY2hWaWV3KGNoaWxkQ29tcG9uZW50UmVmLmhvc3RWaWV3KTtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNoaWxkRG9tRWxlbSk7XG5cbiAgICAgICAgcmV0dXJuIGNoaWxkQ29tcG9uZW50UmVmO1xuICAgIH1cblxuICAgIHByaXZhdGUgc3RhdGljIGF0dGFjaENvbmZpZyhpbnB1dHNDb25maWc6IElOZ3hOb3RpZmljYXRpb25Nc2dDb25maWcsIGNvbXBvbmVudFJlZik6IHZvaWQge1xuICAgICAgICBPYmplY3Qua2V5cyhpbnB1dHNDb25maWcpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIGNvbXBvbmVudFJlZi5pbnN0YW5jZVtrZXldID0gaW5wdXRzQ29uZmlnW2tleV07XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgc3RhdGljIGFkZENoaWxkQ29tcG9uZW50UmVmKGNvbnRhaW5lcjogRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXJUb0NoaWxkQ29tcG9uZW50c1JlZjogQ29udGFpbmVyVG9Db21wb25lbnRzUmVmLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkQ29tcG9uZW50UmVmOiBDaGlsZENvbXBvbmVudFJlZik6IHZvaWQge1xuICAgICAgICBpZiAoY29udGFpbmVyVG9DaGlsZENvbXBvbmVudHNSZWYuaGFzKGNvbnRhaW5lcikpIHtcbiAgICAgICAgICAgIGNvbnRhaW5lclRvQ2hpbGRDb21wb25lbnRzUmVmLmdldChjb250YWluZXIpLnB1c2goY2hpbGRDb21wb25lbnRSZWYpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGFpbmVyVG9DaGlsZENvbXBvbmVudHNSZWYuc2V0KGNvbnRhaW5lciwgW2NoaWxkQ29tcG9uZW50UmVmXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBzdWJzY3JpYmVUb0NvbXBvbmVudERlc3Ryb3lFdmVudChhcHBSZWY6IEFwcGxpY2F0aW9uUmVmLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lclRvQ2hpbGRDb21wb25lbnRzUmVmOiBDb250YWluZXJUb0NvbXBvbmVudHNSZWYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50UmVmOiBDaGlsZENvbXBvbmVudFJlZik6IHZvaWQge1xuICAgICAgICBjb25zdCBzdWIgPSBjb21wb25lbnRSZWYuaW5zdGFuY2UuZGVzdHJveS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgc3ViLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICBOZ3hOb3RpZmljYXRpb25Nc2dTZXJ2aWNlLmRlc3Ryb3koYXBwUmVmLCBjb21wb25lbnRSZWYpO1xuICAgICAgICAgICAgTmd4Tm90aWZpY2F0aW9uTXNnU2VydmljZS5yZW1vdmVDaGlsZENvbXBvbmVudFJlZihjb250YWluZXJUb0NoaWxkQ29tcG9uZW50c1JlZiwgY29tcG9uZW50UmVmKTtcbiAgICAgICAgICAgIE5neE5vdGlmaWNhdGlvbk1zZ1NlcnZpY2UudXBkYXRlQ29tcG9uZW50c0luZGV4ZXNPbkRlc3Ryb3koY29udGFpbmVyVG9DaGlsZENvbXBvbmVudHNSZWYpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBkZXN0cm95KGFwcFJlZjogQXBwbGljYXRpb25SZWYsIGNvbXBvbmVudFJlZjogQ2hpbGRDb21wb25lbnRSZWYpOiB2b2lkIHtcbiAgICAgICAgYXBwUmVmLmRldGFjaFZpZXcoY29tcG9uZW50UmVmLmhvc3RWaWV3KTtcbiAgICAgICAgY29tcG9uZW50UmVmLmRlc3Ryb3koKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyB1cGRhdGVDb21wb25lbnRzSW5kZXhlc09uRGVzdHJveShjb250YWluZXJUb0NoaWxkQ29tcG9uZW50c1JlZjogQ29udGFpbmVyVG9Db21wb25lbnRzUmVmKTogdm9pZCB7XG4gICAgICAgIGNvbnRhaW5lclRvQ2hpbGRDb21wb25lbnRzUmVmLmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHtcbiAgICAgICAgICAgIGxldCB0b3RhbCA9IGNvbnRhaW5lclRvQ2hpbGRDb21wb25lbnRzUmVmLmdldChrZXkpLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBjb250YWluZXJUb0NoaWxkQ29tcG9uZW50c1JlZi5nZXQoa2V5KS5mb3JFYWNoKCh7aW5zdGFuY2V9KSA9PiB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuaW5kZXggPSB0b3RhbC0tO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgc3RhdGljIHJlbW92ZUNoaWxkQ29tcG9uZW50UmVmKGNvbnRhaW5lclRvQ2hpbGRDb21wb25lbnRzUmVmOiBDb250YWluZXJUb0NvbXBvbmVudHNSZWYsIGNvbXBvbmVudFJlZjogQ2hpbGRDb21wb25lbnRSZWYpOiB2b2lkIHtcbiAgICAgICAgY29udGFpbmVyVG9DaGlsZENvbXBvbmVudHNSZWYuZm9yRWFjaCgodmFsdWUsIGtleSkgPT4ge1xuICAgICAgICAgICAgY29udGFpbmVyVG9DaGlsZENvbXBvbmVudHNSZWYuc2V0KGtleSwgWy4uLmNvbnRhaW5lclRvQ2hpbGRDb21wb25lbnRzUmVmLmdldChrZXkpLmZpbHRlcihfID0+IF8gIT09IGNvbXBvbmVudFJlZildKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgdXBkYXRlQ29tcG9uZW50c0luZGV4ZXNPbk9wZW4oY29udGFpbmVyVG9DaGlsZENvbXBvbmVudHNSZWY6IENvbnRhaW5lclRvQ29tcG9uZW50c1JlZik6IHZvaWQge1xuICAgICAgICBjb250YWluZXJUb0NoaWxkQ29tcG9uZW50c1JlZi5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7XG4gICAgICAgICAgICBsZXQgdG90YWwgPSBjb250YWluZXJUb0NoaWxkQ29tcG9uZW50c1JlZi5nZXQoa2V5KS5sZW5ndGg7XG4gICAgICAgICAgICBjb250YWluZXJUb0NoaWxkQ29tcG9uZW50c1JlZi5nZXQoa2V5KS5mb3JFYWNoKCh7aW5zdGFuY2V9KSA9PiB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuaW5kZXggPSAtLXRvdGFsO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9wZW4oaW5wdXRzQ29uZmlnOiBJTmd4Tm90aWZpY2F0aW9uTXNnQ29uZmlnLCBlbGVtZW50PzogRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSBlbGVtZW50ID8gZWxlbWVudCA6IHRoaXMuZGVmYXVsdENvbnRhaW5lcjtcbiAgICAgICAgY29uc3QgY2hpbGRDb21wb25lbnRSZWYgPSBOZ3hOb3RpZmljYXRpb25Nc2dTZXJ2aWNlLmFwcGVuZENoaWxkQ29tcG9uZW50UmVmKFxuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXG4gICAgICAgICAgICB0aGlzLmFwcFJlZixcbiAgICAgICAgICAgIHRoaXMuaW5qZWN0b3IsXG4gICAgICAgICAgICBjb250YWluZXJcbiAgICAgICAgKTtcblxuICAgICAgICBOZ3hOb3RpZmljYXRpb25Nc2dTZXJ2aWNlLmF0dGFjaENvbmZpZyhpbnB1dHNDb25maWcsIGNoaWxkQ29tcG9uZW50UmVmKTtcbiAgICAgICAgTmd4Tm90aWZpY2F0aW9uTXNnU2VydmljZS5hZGRDaGlsZENvbXBvbmVudFJlZihjb250YWluZXIsIHRoaXMuY29udGFpbmVyVG9DaGlsZENvbXBvbmVudHNSZWYsIGNoaWxkQ29tcG9uZW50UmVmKTtcbiAgICAgICAgTmd4Tm90aWZpY2F0aW9uTXNnU2VydmljZS5zdWJzY3JpYmVUb0NvbXBvbmVudERlc3Ryb3lFdmVudCh0aGlzLmFwcFJlZiwgdGhpcy5jb250YWluZXJUb0NoaWxkQ29tcG9uZW50c1JlZiwgY2hpbGRDb21wb25lbnRSZWYpO1xuICAgICAgICBOZ3hOb3RpZmljYXRpb25Nc2dTZXJ2aWNlLnVwZGF0ZUNvbXBvbmVudHNJbmRleGVzT25PcGVuKHRoaXMuY29udGFpbmVyVG9DaGlsZENvbXBvbmVudHNSZWYpO1xuICAgIH1cbn1cblxudHlwZSBDaGlsZENvbXBvbmVudFJlZiA9IENvbXBvbmVudFJlZjxOZ3hOb3RpZmljYXRpb25Nc2dDb21wb25lbnQ+O1xudHlwZSBDb250YWluZXJUb0NvbXBvbmVudHNSZWYgPSBNYXA8RWxlbWVudCwgQ2hpbGRDb21wb25lbnRSZWZbXT47XG4iXX0=